!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){e.exports={Router:({base:e="",routes:t=[]}={})=>({__proto__:new Proxy({},{get:(n,o,r)=>(n,...a)=>t.push([o.toUpperCase(),RegExp(`^${(e+n).replace(/(\/?)\*/g,"($1.*)?").replace(/\/$/,"").replace(/:(\w+)(\?)?(\.)?/g,"$2(?<$1>[^/]+)$2$3").replace(/\.(?=[\w(])/,"\\.")}/*$`),a])&&r}),routes:t,async handle(e,...n){let o,r,a=new URL(e.url);for(var[s,i,c]of(e.query=Object.fromEntries(a.searchParams),t))if((s===e.method||"ALL"===s)&&(r=a.pathname.match(i)))for(var u of(e.params=r.groups,c))if(void 0!==(o=await u(e.proxy||e,...n)))return o}})}},function(e,t,n){"use strict";n.r(t);var o=n(0);async function r(e,t){const n=e.headers.get("x-slack-request-timestamp");console.log("verifySlackSignature"),console.log(n);const o=function(e){const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)t[n/2]=parseInt(e.substr(n,2),16);return t.buffer}(e.headers.get("x-slack-signature").substring(3)),r=`v0:${n}:${await e.clone().text()}`;let a=new TextEncoder;const s=await crypto.subtle.importKey("raw",a.encode(t),{name:"HMAC",hash:"SHA-256"},!1,["verify"]),i=await crypto.subtle.verify("HMAC",s,o,a.encode(r));return console.log(i),i}async function a(e){const t=await e.text(),n=new URLSearchParams(t).get("text"),o="https://api.github.com/users/"+n;console.log("handleInviteRequest"),console.log("username "+n);const r=await fetch(o,{method:"GET",headers:{"User-Agent":"aditsachde",Accept:"application/vnd.github.v3+json",Authorization:"token "+GITHUB_TOKEN}}),a=r.status;if(console.log(a),console.log(r),200!==a)return new Response("Username not found!",{status:200});let s=(await r.json()).id;console.log("inviting user: "+s);const i=JSON.stringify({invitee_id:s});console.log(i);const c=await fetch("https://api.github.com/orgs/ramblinrocketclub/invitations",{method:"POST",headers:{"User-Agent":"aditsachde",Accept:"application/vnd.github.v3+json",Authorization:"token "+GITHUB_TOKEN},body:i}),u=c.status;return console.log(u),console.log(c),201!==u?new Response("Failed to create invite! You may already be in the organization!",{status:200}):new Response("User "+n+"invited to the RRC organization. Please check your email!",{status:200})}const s=Object(o.Router)();s.post("/rrc",async e=>{if(!await r(e,SLACK_SIGNING_SECRET_RRC))return console.log("not authenticated"),new Response("Not Authenticated",{status:401})},async e=>(console.log("handling invite request @ rrc"),await a(e))),s.post("/hab",async e=>{if(!await r(e,SLACK_SIGNING_SECRET_HAB))return new Response("Not Authenticated",{status:401})},async e=>(console.log("handling invite request @ hab"),await a(e))),s.post("/gtxr",async e=>{if(!await r(e,SLACK_SIGNING_SECRET_GTXR))return new Response("Not Authenticated",{status:401})},async e=>(console.log("handling invite request @ gtxr"),await a(e))),s.all("*",()=>new Response("404, not found!",{status:404})),addEventListener("fetch",e=>{e.respondWith(s.handle(e.request))})}]);